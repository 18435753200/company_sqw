<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.mall.supplier.dao.SupplierMapper">
	<resultMap id="BaseResultMap" type="com.mall.supplier.model.Supplier">
		<id column="supplier_id" property="supplierId" jdbcType="INTEGER" />
		<result column="supplier_code" property="supplierCode"
			jdbcType="VARCHAR" />
		<result column="name" property="name" jdbcType="VARCHAR" />
		<result column="type" property="type" jdbcType="INTEGER" />
		<result column="parent_id" property="parentId" jdbcType="INTEGER" />
		<result column="grade" property="grade" jdbcType="INTEGER" />
		
		<result column="business_licenseno" property="businessLicenseNo" jdbcType="VARCHAR" />
	 	<result column="legal_person_cardtype" property="legalPersonCardType" jdbcType="VARCHAR" />
		<result column="legal_person_cardno" property="legalPersonCardNo" jdbcType="VARCHAR" />
		<result column="legal_person_phone" property="legalPersonPhone" jdbcType="VARCHAR" />
		<result column="tax_licenseno" property="taxLicenseNo" jdbcType="VARCHAR" />
		<result column="company_store_logo" property="companyStoreLogo" jdbcType="VARCHAR" />
		<result column="accout_name" property="accountName" jdbcType="VARCHAR" />
		<result column="accout_bankname" property="accoutBankname" jdbcType="VARCHAR" />
		<result column="accout_no" property="accountNo" jdbcType="VARCHAR" />
		<result column="accout_bankno" property="accoutBankno" jdbcType="VARCHAR" />
		<result column="register_address" property="registerAddress" jdbcType="VARCHAR" />
		
		
		<result column="organization_type" property="organizationType"
			jdbcType="INTEGER" />
		<result column="organizational_form" property="organizationalForm"
			jdbcType="CHAR" />
		<result column="business_license" property="businessLicense"
			jdbcType="VARCHAR" />
		<result column="business_scale" property="businessScale"
			jdbcType="INTEGER" />
		<result column="health_license" property="healthLicense"
			jdbcType="VARCHAR" />
		<result column="lines_of_credit" property="linesOfCredit"
			jdbcType="VARCHAR" />
		<result column="legal_person" property="legalPerson" jdbcType="VARCHAR" />
		<result column="tax_license" property="taxLicense" jdbcType="VARCHAR" />
		<result column="franchise_license" property="franchiseLicense"
			jdbcType="VARCHAR" />
		<result column="main_category" property="mainCategory"
			jdbcType="VARCHAR" />
		<result column="province_id" property="provinceId" jdbcType="INTEGER" />
		<result column="city_id" property="cityId" jdbcType="INTEGER" />
		<result column="area_id" property="areaId" jdbcType="INTEGER" />
		<result column="address" property="address" jdbcType="VARCHAR" />
		<result column="contact" property="contact" jdbcType="VARCHAR" />
		<result column="email" property="email" jdbcType="VARCHAR" />
		<result column="phone" property="phone" jdbcType="VARCHAR" />
		<result column="fax" property="fax" jdbcType="VARCHAR" />
		<result column="post" property="post" jdbcType="INTEGER" />
		<result column="create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="create_by" property="createBy" jdbcType="VARCHAR" />
		<result column="last_modify_time" property="lastModifyTime"
			jdbcType="TIMESTAMP" />
		<result column="last_modify_by" property="lastModifyBy"
			jdbcType="INTEGER" />
		<result column="audit_time" property="auditTime" jdbcType="TIMESTAMP" />
		<result column="status" property="status" jdbcType="INTEGER" />
		<result column="company_website" property="companyWebsite"
			jdbcType="VARCHAR" />
		<result column="company_nature" property="companyNature"
			jdbcType="VARCHAR" />
		<result column="country_area" property="countryArea" jdbcType="VARCHAR" />
		<result column="icon" property="icon" jdbcType="VARCHAR" />
		<result column="company_describe" property="companyDescribe"
			jdbcType="VARCHAR" />
		<result column="company_legitimacy_url" property="companyLegitimacyUrl"
			jdbcType="VARCHAR" />
		<result column="company_detailed_url" property="companyDetailedUrl"
			jdbcType="VARCHAR" />
		<result column="check_fail_reason" property="checkFailReason"
			jdbcType="VARCHAR" />
		<result column="supply_type" property="supplyType" jdbcType="INTEGER" />
		<result column="is_onkey_send" property="isOnekeySend"
			jdbcType="INTEGER" />
		<result column="company_region" property="companyRegion"
			jdbcType="VARCHAR" />
		<result column="name_jc" property="nameJC" jdbcType="VARCHAR" />
		<result column="company_info" property="companyInfo" jdbcType="VARCHAR" />
		<result column="company_level" property="companyLevel"
			jdbcType="VARCHAR" />
		<result column="manager" property="manager" jdbcType="VARCHAR" />
		<result column="manager_tel" property="managerTel" jdbcType="VARCHAR" />
		<result column="kf_tel" property="kfTel" jdbcType="VARCHAR" />
		<result column="user_tj" property="userTj" jdbcType="VARCHAR" />
		<result column="logo_imgurl" property="logoImgurl" jdbcType="VARCHAR" />
		<result column="manager_backup" property="managerBackup"
			jdbcType="VARCHAR" />
		<result column="manager_tel_backup" property="managerTelBackup"
			jdbcType="VARCHAR" />
		<result column="kf_tel_backup" property="kfTelBackup" jdbcType="VARCHAR" />
		<result column="address_backup" property="addressBackup"
			jdbcType="VARCHAR" />
		<result column="contact_backup" property="contactBackup"
			jdbcType="VARCHAR" />
		<result column="phone_backup" property="phoneBackup" jdbcType="VARCHAR" />
		<result column="email_backup" property="emailBackup" jdbcType="VARCHAR" />
		<result column="fax_backup" property="faxBackup" jdbcType="VARCHAR" />
		<result column="country_area_backup" property="countryAreaBackup"
			jdbcType="VARCHAR" />
		<result column="post_backup" property="postBackup" jdbcType="VARCHAR" />
		<result column="logo_imgurl_backup" property="logoImgurlBackup"
			jdbcType="VARCHAR" />
		<result column="modify_status" property="modifyStatus"
			jdbcType="INTEGER" />
		<result column="company_qy" property="companyQy" jdbcType="VARCHAR" />
		<result column="sj_supplier_id" property="sjSupplierId"
			jdbcType="VARCHAR" />
		<result column="user_name" property="userName" jdbcType="VARCHAR" />
		<result column="user_mobile" property="userMobile" jdbcType="VARCHAR" />
		<result column="hqq_pwd" property="hqqPwd" jdbcType="VARCHAR" />
		<result column="no_pay_hqq" property="noPayhqq" jdbcType="DECIMAL" />
		<result column="remain_balance_amount" property="remainBalanceAmount"
			jdbcType="DECIMAL" />
		<result column="fanli_price" property="fanliPrice" jdbcType="DECIMAL" />
		<result column="active_status" property="activeStatus"
			jdbcType="INTEGER" />
		<result column="" property="level" jdbcType="INTEGER" />
		<result column="user_id" property="userId" jdbcType="INTEGER" />
		<result column="idCard_front" property="idCardFront" jdbcType="VARCHAR" />
		<result column="idCard_verso" property="idCardVerso" jdbcType="VARCHAR" />
		<result column="zk" property="discount" jdbcType="DECIMAL" />
		<result column="company_biz_category" property="companyBizCategory" jdbcType="INTEGER" />
		<result column="company_biz_type" property="companyBizType" jdbcType="INTEGER" />
		<result column="contact_tel" property="contactTel" jdbcType="VARCHAR" />
		<result column="withdraw_status" property="withdrawStatus" jdbcType="INTEGER" />
	</resultMap>

	<!-- <resultMap id="dtoMap" type="" > <result column="supplier_id" property="supplierId" 
		jdbcType="INTEGER" /> <result column="name" property="name" jdbcType="VARCHAR" 
		/> </resultMap> -->

	<select id="selectCount" resultType="java.lang.Integer"
		parameterType="java.lang.Long">
		select
		 COUNT(*) from s_supplier where
		user_id = #{userId,jdbcType=INTEGER}
	</select>


	<sql id="Base_Column_List">
		supplier_id, supplier_code, name, type, parent_id, grade,supply_type,
		organization_type, organizational_form,company_legitimacy_url,contact_tel,register_address,
		business_licenseno,legal_person_cardtype,legal_person_cardno,legal_person_phone,
		tax_licenseno,company_store_logo,accout_name,accout_bankname,accout_no,accout_bankno,
		business_license, business_scale, health_license, lines_of_credit, legal_person,
		tax_license, franchise_license, main_category, province_id, city_id,
		area_id, address, contact,company_describe,withdraw_status,
		email, phone, fax, post, create_time, create_by, last_modify_time,
		last_modify_by,company_biz_category,company_biz_type,logo_imgurl,
		audit_time,status, company_website, company_nature, country_area, icon,
		company_detailed_url,check_fail_reason,is_onkey_send,company_region,name_jc,company_info,company_level,manager,
		phone_backup,email_backup,fax_backup,country_area_backup,post_backup,logo_imgurl_backup,modify_status,company_qy,sj_supplier_id,
		user_name,user_mobile,hqq_pwd,no_pay_hqq,remain_balance_amount,fanli_price,active_status,user_id,idCard_front,idCard_verso,zk
	</sql>
	<select id="selectByPrimaryKey" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</select>
	
	<select id="getSupplierByuserId" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where  organization_type = #{organizationType,jdbcType=INTEGER} and user_id = #{userId,jdbcType=INTEGER}
	</select>
	
	<select id="getSupplierByuserIdForhqy" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where  organization_type = 6 and user_id = #{userId,jdbcType=INTEGER}
	</select>
	
	<delete id="deleteByPrimaryKey" parameterType="java.lang.Long">
		update s_supplier set status=0
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</delete>
	<insert id="insert" parameterType="com.mall.supplier.model.Supplier">
		insert into s_supplier (supplier_id, supplier_code, name,
		type, parent_id, grade,
		organization_type, organizational_form, business_license,
		business_scale, health_license, lines_of_credit,
		legal_person, tax_license, franchise_license,
		main_category, province_id, city_id,
		area_id, address, email,
		phone, fax, post, create_time,
		create_by, last_modify_time, last_modify_by,
		status, company_website, company_nature,
		country_area, icon, company_describe,
		company_legitimacy_url, company_detailed_url, user_id,idCard_front,idCard_verso
		)
		values (#{supplierId,jdbcType=INTEGER}, #{supplierCode,jdbcType=VARCHAR},
		#{name,jdbcType=VARCHAR},
		#{type,jdbcType=INTEGER}, #{parentId,jdbcType=INTEGER}, #{grade,jdbcType=INTEGER},
		#{organizationType,jdbcType=INTEGER},
		#{organizationalForm,jdbcType=CHAR},
		#{businessLicense,jdbcType=VARCHAR},
		#{businessScale,jdbcType=INTEGER}, #{healthLicense,jdbcType=VARCHAR},
		#{linesOfCredit,jdbcType=VARCHAR},
		#{legalPerson,jdbcType=VARCHAR}, #{taxLicense,jdbcType=VARCHAR}, #{franchiseLicense,jdbcType=VARCHAR},
		#{mainCategory,jdbcType=VARCHAR}, #{provinceId,jdbcType=INTEGER},
		#{cityId,jdbcType=INTEGER},
		#{areaId,jdbcType=INTEGER}, #{address,jdbcType=VARCHAR}, #{email,jdbcType=VARCHAR},
		#{phone,jdbcType=VARCHAR}, #{fax,jdbcType=VARCHAR},
		#{post,jdbcType=INTEGER}, #{createTime,jdbcType=TIMESTAMP},
		#{createBy,jdbcType=VARCHAR}, #{lastModifyTime,jdbcType=TIMESTAMP},
		#{lastModifyBy,jdbcType=INTEGER},
		#{status,jdbcType=INTEGER}, #{companyWebsite,jdbcType=VARCHAR},
		#{companyNature,jdbcType=VARCHAR},
		#{countryArea,jdbcType=VARCHAR}, #{icon,jdbcType=VARCHAR}, #{companyDescribe,jdbcType=VARCHAR},
		#{companyLegitimacyUrl,jdbcType=VARCHAR},
		#{companyDetailedUrl,jdbcType=VARCHAR},#{userId,jdbcType=INTEGER},
        #{idCard_front,jdbcType=VARCHAR},#{idCard_verso,jdbcType=VARCHAR}
		)
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="supplierId">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	
	
	<insert id="insertSelective" parameterType="com.mall.supplier.model.Supplier">
		insert into s_supplier
		<trim prefix="(" suffix=")" suffixOverrides=",">
		<if test="companyQy != null">
				company_qy,
			</if>
			<if test="businessLicenseNo != null">
				business_licenseno,
			</if>
			<if test="companyStoreLogo != null">
				company_store_logo,
			</if>
			<if test="accoutBankno != null">
				accout_bankno,
			</if>
			<if test="accoutBankname != null">
				accout_bankname,
			</if>
			<if test="accountNo != null">
				accout_no,
			</if>
			<if test="accountName != null">
				accout_name,
			</if>
			<if test="legalPersonCardNo != null">
				legal_person_cardno,
			</if>
			<if test="legalPersonCardType != null">
				legal_person_cardtype,
			</if>
			<if test="legalPersonPhone != null">
				legal_person_phone,
			</if>
			<if test="contactTel != null">
				contact_tel,
			</if>
			<if test="registerAddress != null">
				register_address,
			</if>
			<if test="supplierId != null">
				supplier_id,
			</if>
			<if test="userId != null">
				user_id,
			</if>
			<if test="supplierCode != null">
				supplier_code,
			</if>
			<if test="name != null">
				name,
			</if>
			<if test="type != null">
				type,
			</if>
			<if test="parentId != null">
				parent_id,
			</if>
			<if test="grade != null">
				grade,
			</if>
			<if test="organizationType != null">
				organization_type,
			</if>
			<if test="organizationalForm != null">
				organizational_form,
			</if>
			<if test="businessLicense != null">
				business_license,
			</if>
			<if test="businessScale != null">
				business_scale,
			</if>
			<if test="healthLicense != null">
				health_license,
			</if>
			<if test="linesOfCredit != null">
				lines_of_credit,
			</if>
			<if test="legalPerson != null">
				legal_person,
			</if>
			<if test="taxLicense != null">
				tax_license,
			</if>
			<if test="franchiseLicense != null">
				franchise_license,
			</if>
			<if test="mainCategory != null">
				main_category,
			</if>
			<if test="provinceId != null">
				province_id,
			</if>
			<if test="cityId != null">
				city_id,
			</if>
			<if test="areaId != null">
				area_id,
			</if>
			<if test="address != null">
				address,
			</if>
			<if test="contact != null">
				contact,
			</if>
			<if test="email != null">
				email,
			</if>
			<if test="phone != null">
				phone,
			</if>
			<if test="fax != null">
				fax,
			</if>
			<if test="post != null">
				post,
			</if>
			<if test="createTime != null">
				create_time,
			</if>
			<if test="createBy != null">
				create_by,
			</if>
			<if test="lastModifyTime != null">
				last_modify_time,
			</if>
			<if test="lastModifyBy != null">
				last_modify_by,
			</if>
			<if test="status != null">
				status,
			</if>
			<if test="companyWebsite != null">
				company_website,
			</if>
			<if test="companyNature != null">
				company_nature,
			</if>
			<if test="countryArea != null">
				country_area,
			</if>
			<if test="icon != null">
				icon,
			</if>
			<if test="companyDescribe != null">
				company_describe,
			</if>
			<if test="companyLegitimacyUrl != null">
				company_legitimacy_url,
			</if>
			<if test="companyDetailedUrl != null">
				company_detailed_url,
			</if>
			<if test="supplyType != null">
				supply_type,
			</if>
			<if test="nameJC != null">
				name_jc,
			</if>
			<if test="companyInfo != null">
				company_info,
			</if>
			<if test="companyLevel != null">
				company_level,
			</if>
			<if test="companyRegion != null">
				company_region,
			</if>
			<if test="manager != null">
				manager,
			</if>
			<if test="managerTel != null">
				manager_tel,
			</if>
			<if test="kfTel != null">
				kf_tel,
			</if>
			<if test="userTj != null">
				user_tj,
			</if>
			<if test="logoImgurl != null">
				logo_imgurl,
			</if>
			<if test="sjSupplierId != null">
				sj_supplier_id,
			</if>
			<if test="userName != null">
				user_name,
			</if>
			<if test="userMobile != null">
				user_mobile,
			</if>
			<if test="hqqPwd != null">
				hqq_pwd,
			</if>
			<if test="noPayhqq != null">
				no_pay_hqq,
			</if>
			<if test="remainBalanceAmount != null">
				remain_balance_amount,
			</if>
			<if test="activeStatus != null">
				active_status,
			</if>
            <if test="idCardFront != null">
                idCard_front,
			</if>
			<if test="idCardVerso != null">
                idCard_verso,
			</if>
            <if test="discount != null">
                zk,
			</if>
			<if test="companyBizType != null">
                company_biz_type,
			</if>
            <if test="companyBizCategory != null">
                company_biz_category,
			</if>

		</trim>
		<trim prefix="values (" suffix=")" suffixOverrides=",">
		<if test="companyQy != null">
				#{companyQy,jdbcType=INTEGER},
			</if>
			<if test="businessLicenseNo != null">
				#{businessLicenseNo,jdbcType=VARCHAR},
			</if>
			<if test="companyStoreLogo != null">
				#{companyStoreLogo,jdbcType=VARCHAR},
			</if>
			<if test="accoutBankno != null">
				#{accoutBankno,jdbcType=VARCHAR},
			</if>
			<if test="accoutBankname != null">
				#{accoutBankname,jdbcType=VARCHAR},
			</if>
			<if test="accountNo != null">
				#{accountNo,jdbcType=VARCHAR},
			</if>
			<if test="accountName != null">
				#{accountName,jdbcType=VARCHAR},
			</if>
			<if test="legalPersonCardNo != null">
				#{legalPersonCardNo,jdbcType=VARCHAR},
			</if>
			<if test="legalPersonCardType != null">
				#{legalPersonCardType,jdbcType=VARCHAR},
			</if>
			<if test="legalPersonPhone != null">
				#{legalPersonPhone,jdbcType=VARCHAR},
			</if>
			<if test="contactTel != null">
				#{contactTel,jdbcType=VARCHAR},
			</if>
			<if test="registerAddress != null">
				#{registerAddress,jdbcType=VARCHAR},
			</if>
			<if test="supplierId != null">
				#{supplierId,jdbcType=INTEGER},
			</if>
			<if test="userId != null">
				#{userId,jdbcType=INTEGER},
			</if>
			<if test="supplierCode != null">
				#{supplierCode,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				#{name,jdbcType=VARCHAR},
			</if>
			<if test="type != null">
				#{type,jdbcType=INTEGER},
			</if>
			<if test="parentId != null">
				#{parentId,jdbcType=INTEGER},
			</if>
			<if test="grade != null">
				#{grade,jdbcType=INTEGER},
			</if>
			<if test="organizationType != null">
				#{organizationType,jdbcType=INTEGER},
			</if>
			<if test="organizationalForm != null">
				#{organizationalForm,jdbcType=CHAR},
			</if>
			<if test="businessLicense != null">
				#{businessLicense,jdbcType=VARCHAR},
			</if>
			<if test="businessScale != null">
				#{businessScale,jdbcType=INTEGER},
			</if>
			<if test="healthLicense != null">
				#{healthLicense,jdbcType=VARCHAR},
			</if>
			<if test="linesOfCredit != null">
				#{linesOfCredit,jdbcType=VARCHAR},
			</if>
			<if test="legalPerson != null">
				#{legalPerson,jdbcType=VARCHAR},
			</if>
			<if test="taxLicense != null">
				#{taxLicense,jdbcType=VARCHAR},
			</if>
			<if test="franchiseLicense != null">
				#{franchiseLicense,jdbcType=VARCHAR},
			</if>
			<if test="mainCategory != null">
				#{mainCategory,jdbcType=VARCHAR},
			</if>
			<if test="provinceId != null">
				#{provinceId,jdbcType=INTEGER},
			</if>
			<if test="cityId != null">
				#{cityId,jdbcType=INTEGER},
			</if>
			<if test="areaId != null">
				#{areaId,jdbcType=INTEGER},
			</if>
			<if test="address != null">
				#{address,jdbcType=VARCHAR},
			</if>
			<if test="contact != null">
				#{contact,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				#{email,jdbcType=VARCHAR},
			</if>
			<if test="phone != null">
				#{phone,jdbcType=VARCHAR},
			</if>
			<if test="fax != null">
				#{fax,jdbcType=VARCHAR},
			</if>
			<if test="post != null">
				#{post,jdbcType=INTEGER},
			</if>
			<if test="createTime != null">
				#{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="createBy != null">
				#{createBy,jdbcType=VARCHAR},
			</if>
			<if test="lastModifyTime != null">
				#{lastModifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="lastModifyBy != null">
				#{lastModifyBy,jdbcType=INTEGER},
			</if>
			<if test="status != null">
				#{status,jdbcType=INTEGER},
			</if>
			<if test="companyWebsite != null">
				#{companyWebsite,jdbcType=VARCHAR},
			</if>
			<if test="companyNature != null">
				#{companyNature,jdbcType=VARCHAR},
			</if>
			<if test="countryArea != null">
				#{countryArea,jdbcType=VARCHAR},
			</if>
			<if test="icon != null">
				#{icon,jdbcType=VARCHAR},
			</if>
			<if test="companyDescribe != null">
				#{companyDescribe,jdbcType=VARCHAR},
			</if>
			<if test="companyLegitimacyUrl != null">
				#{companyLegitimacyUrl,jdbcType=VARCHAR},
			</if>
			<if test="companyDetailedUrl != null">
				#{companyDetailedUrl,jdbcType=VARCHAR},
			</if>
			<if test="supplyType != null">
				#{supplyType,jdbcType=INTEGER},
			</if>
			<if test="nameJC != null">
				#{nameJC,jdbcType=VARCHAR},
			</if>
			<if test="companyInfo != null">
				#{companyInfo,jdbcType=VARCHAR},
			</if>
			<if test="companyLevel != null">
				#{companyLevel,jdbcType=VARCHAR},
			</if>
			<if test="companyRegion != null">
				#{companyRegion,jdbcType=VARCHAR},
			</if>
			<if test="manager != null">
				#{manager,jdbcType=VARCHAR},
			</if>
			<if test="managerTel != null">
				#{managerTel,jdbcType=VARCHAR},
			</if>
			<if test="kfTel != null">
				#{kfTel,jdbcType=VARCHAR},
			</if>
			<if test="userTj != null">
				#{userTj,jdbcType=VARCHAR},
			</if>
			<if test="logoImgurl != null">
				#{logoImgurl,jdbcType=VARCHAR},
			</if>
			<if test="sjSupplierId != null">
				#{sjSupplierId,jdbcType=VARCHAR},
			</if>
			<if test="userName != null">
				#{userName,jdbcType=VARCHAR},
			</if>
			<if test="userMobile != null">
				#{userMobile,jdbcType=VARCHAR},
			</if>
			<if test="hqqPwd != null">
				#{hqqPwd,jdbcType=VARCHAR},
			</if>
			<if test="noPayhqq != null">
				#{noPayhqq,jdbcType=DECIMAL},
			</if>
			<if test="remainBalanceAmount != null">
				#{remainBalanceAmount,jdbcType=DECIMAL},
			</if>
			<if test="activeStatus != null">
				#{activeStatus,jdbcType=INTEGER},
			</if>
            <if test="idCardFront != null">
                #{idCardFront,jdbcType=VARCHAR},
            </if>
            <if test="idCardVerso != null">
                #{idCardVerso,jdbcType=VARCHAR},
            </if>
            <if test="discount != null">
                #{zk,jdbcType=DECIMAL},
            </if>
			<if test="companyBizType != null">
				#{companyBizType,jdbcType=INTEGER},
			</if>
			<if test="companyBizCategory != null">
				#{companyBizCategory,jdbcType=INTEGER},
			</if>
			
		</trim>
		<selectKey resultType="java.lang.Long" order="AFTER"
			keyProperty="supplierId">
			SELECT LAST_INSERT_ID()
		</selectKey>
	</insert>
	<update id="updateActive" parameterType="java.lang.Long">
		update s_supplier set active_status=-1 where supplier_id = #{supplierId,jdbcType=INTEGER}
	
	</update>
	<update id="updateByPrimaryKeySelective" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier
		<set>
			<if test="supplierCode != null">
				supplier_code = #{supplierCode,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="type != null">
				type = #{type,jdbcType=INTEGER},
			</if>
			<if test="parentId != null">
				parent_id = #{parentId,jdbcType=INTEGER},
			</if>
			<if test="grade != null">
				grade = #{grade,jdbcType=INTEGER},
			</if>
			<if test="organizationType != null">
				organization_type = #{organizationType,jdbcType=INTEGER},
			</if>
			<if test="organizationalForm != null">
				organizational_form = #{organizationalForm,jdbcType=CHAR},
			</if>
			<if test="businessLicense != null">
				business_license = #{businessLicense,jdbcType=VARCHAR},
			</if>
			<if test="businessScale != null">
				business_scale = #{businessScale,jdbcType=INTEGER},
			</if>
			<if test="healthLicense != null">
				health_license = #{healthLicense,jdbcType=VARCHAR},
			</if>
			<if test="linesOfCredit != null">
				lines_of_credit = #{linesOfCredit,jdbcType=VARCHAR},
			</if>
			<if test="legalPerson != null">
				legal_person = #{legalPerson,jdbcType=VARCHAR},
			</if>
			<if test="taxLicense != null">
				tax_license = #{taxLicense,jdbcType=VARCHAR},
			</if>
			<if test="franchiseLicense != null">
				franchise_license = #{franchiseLicense,jdbcType=VARCHAR},
			</if>
			<if test="mainCategory != null">
				main_category = #{mainCategory,jdbcType=VARCHAR},
			</if>
			<if test="provinceId != null">
				province_id = #{provinceId,jdbcType=INTEGER},
			</if>
			<if test="cityId != null">
				city_id = #{cityId,jdbcType=INTEGER},
			</if>
			<if test="areaId != null">
				area_id = #{areaId,jdbcType=INTEGER},
			</if>
			<if test="address != null">
				address = #{address,jdbcType=VARCHAR},
			</if>
			<if test="contact != null">
				contact = #{contact,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				email = #{email,jdbcType=VARCHAR},
			</if>
			<if test="phone != null">
				phone = #{phone,jdbcType=VARCHAR},
			</if>
			<if test="fax != null">
				fax = #{fax,jdbcType=VARCHAR},
			</if>
			<if test="post != null">
				post = #{post,jdbcType=INTEGER},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="createBy != null">
				create_by = #{createBy,jdbcType=VARCHAR},
			</if>
			<if test="lastModifyTime != null">
				last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="lastModifyBy != null">
				last_modify_by = #{lastModifyBy,jdbcType=INTEGER},
			</if>
			<if test="auditTime != null">
				audit_time = #{auditTime,jdbcType=DATE},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=INTEGER},
			</if>
			<if test="companyWebsite != null">
				company_website = #{companyWebsite,jdbcType=VARCHAR},
			</if>
			<if test="companyNature != null">
				company_nature = #{companyNature,jdbcType=VARCHAR},
			</if>
			<if test="countryArea != null">
				country_area = #{countryArea,jdbcType=VARCHAR},
			</if>
			<if test="icon != null">
				icon = #{icon,jdbcType=VARCHAR},
			</if>
			<if test="companyDescribe != null">
				company_describe = #{companyDescribe,jdbcType=VARCHAR},
			</if>
			<if test="companyLegitimacyUrl != null">
				company_legitimacy_url = #{companyLegitimacyUrl,jdbcType=VARCHAR},
			</if>
			<if test="companyDetailedUrl != null">
				company_detailed_url = #{companyDetailedUrl,jdbcType=VARCHAR},
			</if>
			<if test="checkFailReason != null">
				check_fail_reason = #{checkFailReason,jdbcType=VARCHAR},
			</if>
			<if test="supplyType != null">
				supply_type = #{supplyType,jdbcType=INTEGER},
			</if>
			<if test="isOnekeySend != null">
				is_onkey_send = #{isOnekeySend,jdbcType=INTEGER},
			</if>
			<if test="manager != null">
				manager = #{manager,jdbcType=VARCHAR},
			</if>
			<if test="managerTel != null">
				manager_tel = #{managerTel,jdbcType=VARCHAR},
			</if>
			<if test="kfTel != null">
				kf_tel = #{kfTel,jdbcType=VARCHAR},
			</if>
			<if test="logoImgurl != null">
				logo_imgurl = #{logoImgurl,jdbcType=VARCHAR},
			</if>
			<if test="companyQy != null">
				company_qy = #{companyQy,jdbcType=VARCHAR},
			</if>
			<if test="companyRegion != null">
				company_region = #{companyRegion,jdbcType=VARCHAR},
			</if>
			<if test="modifyStatus != null">
				modify_Status = #{modifyStatus,jdbcType=INTEGER},
			</if>
			<if test="companyLevel != null">
				company_level = #{companyLevel,jdbcType=VARCHAR},
			</if>
			<if test="noPayhqq != null">
				no_pay_hqq = #{noPayhqq,jdbcType=DECIMAL},
			</if>
			<if test="sjSupplierId != null">
				sj_supplier_id = #{sjSupplierId,jdbcType=VARCHAR},
			</if>
			<if test="activeStatus != null">
				active_status = #{activeStatus,jdbcType=INTEGER},
			</if>
			<if test="remainBalanceAmount != null">
				remain_balance_amount = #{remainBalanceAmount,jdbcType=DECIMAL},
			</if>
			<if test="fanliPrice != null">
				fanli_price = #{fanliPrice,jdbcType=DECIMAL},
			</if>
            <if test="idCardFront != null">
                idCard_front = #{idCardFront,jdbcType=VARCHAR},
            </if>
            <if test="idCardVerso != null">
                idCard_verso = #{idCardVerso,jdbcType=VARCHAR},
            </if>
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<update id="updateByPrimaryKey" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier
		set supplier_code = #{supplierCode,jdbcType=VARCHAR},
		name = #{name,jdbcType=VARCHAR},
		type = #{type,jdbcType=INTEGER},
		parent_id = #{parentId,jdbcType=INTEGER},
		grade = #{grade,jdbcType=INTEGER},
		organization_type = #{organizationType,jdbcType=INTEGER},
		organizational_form = #{organizationalForm,jdbcType=CHAR},
		business_license = #{businessLicense,jdbcType=VARCHAR},
		business_scale = #{businessScale,jdbcType=INTEGER},
		health_license = #{healthLicense,jdbcType=VARCHAR},
		lines_of_credit = #{linesOfCredit,jdbcType=VARCHAR},
		legal_person = #{legalPerson,jdbcType=VARCHAR},
		tax_license = #{taxLicense,jdbcType=VARCHAR},
		franchise_license = #{franchiseLicense,jdbcType=VARCHAR},
		main_category = #{mainCategory,jdbcType=VARCHAR},
		province_id = #{provinceId,jdbcType=INTEGER},
		city_id = #{cityId,jdbcType=INTEGER},
		area_id = #{areaId,jdbcType=INTEGER},
		address = #{address,jdbcType=VARCHAR},
		contact = #{contact,jdbcType=VARCHAR},
		email = #{email,jdbcType=VARCHAR},
		phone = #{phone,jdbcType=VARCHAR},
		fax = #{fax,jdbcType=VARCHAR},
		post = #{post,jdbcType=INTEGER},
		create_time = #{createTime,jdbcType=TIMESTAMP},
		create_by = #{createBy,jdbcType=VARCHAR},
		last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP},
		last_modify_by = #{lastModifyBy,jdbcType=INTEGER},
		status = #{status,jdbcType=INTEGER},
		company_website = #{companyWebsite,jdbcType=VARCHAR},
		company_nature = #{companyNature,jdbcType=VARCHAR},
		country_area = #{countryArea,jdbcType=VARCHAR},
		icon = #{icon,jdbcType=VARCHAR},
		company_describe = #{companyDescribe,jdbcType=VARCHAR},
		company_legitimacy_url = #{companyLegitimacyUrl,jdbcType=VARCHAR},
		supply_type = #{supplyType,jdbcType=INTEGER},
		company_detailed_url = #{companyDetailedUrl,jdbcType=VARCHAR}
            idCard_front = #{idCardFront,jdbcType=VARCHAR},
            idCard_verso = #{idCardVerso,jdbcType=VARCHAR},
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<select id="getSupplierIdsByName" resultType="java.lang.Long"
		parameterType="java.lang.String">
		select
		supplier_id
		from s_supplier
		where status=1 and name like CONCAT('%',#{name,jdbcType=VARCHAR},'%')
	</select>
	<select id="findAllSupplier" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status=1 and name like
		CONCAT('%',#{supplierName,jdbcType=VARCHAR},'%')
	</select>

	<select id="findAllSupplierByNameAndType" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status = 1
		<if test="supplierName != null and supplierName !='' ">
			and name like CONCAT('%',#{supplierName,jdbcType=VARCHAR},'%')
		</if>
		<if test="supplyType != null and supplyType !=''">
			and supply_type = #{supplyType}
		</if>
		<if test="supplyType == null or supplyType ==''">
			and (supply_type is null or supply_type != 50 )
		</if>
	</select>

	<select id="findVirtualSupplier" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status=1
		<if test="supplyType != null">
			and supply_type = #{supplyType}
		</if>
		<if test="supplierName != null and supplierName !='' ">
			and name like CONCAT('%',#{supplierName,jdbcType=VARCHAR},'%')
		</if>
	</select>

	<select id="findAllSuppliers" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
	</select>
	<!-- 商户列表 -->
	<select id="getPageList" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and (COMPANY_QY!=10 or COMPANY_QY is null)
		and (organization_type NOT IN (1,6,12))
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	<select id="getPageList1" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and COMPANY_QY=10
		and (organization_type !=6 )
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	<select id="getPageListAgent" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and (COMPANY_QY!=10 or COMPANY_QY is null)
		and organization_type =12 
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
<!-- 		因为传入的值为0时,mybatis会把改值设为null,因此不进入上面的判断,所以需要再写一遍 -->
		<if test="parameter.status == 0">
				and status = 0 
		</if>
		<if test="parameter.activeStatus != null and parameter.activeStatus !='' ">
			and active_status =#{parameter.activeStatus,jdbcType=INTEGER}
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	<select id="getPageListAgentSupplier" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where 
		(COMPANY_QY!=10 or COMPANY_QY is null)
		and organization_type =12 
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' and parameter.status !=6" >
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.status == 6">
				and <![CDATA[status in (0,1)]]>
		</if>
<!-- 		因为传入的值为0时,mybatis会把改值设为null,因此不进入上面的判断,所以需要再写一遍 -->
		<if test="parameter.status == 0">
				and status = 0 
		</if>
		<if test="parameter.activeStatus != null and parameter.activeStatus !='' ">
			and active_status =#{parameter.activeStatus,jdbcType=INTEGER}
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	<select id="getPageList2" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and organization_type =6
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	
	<select id="getPageListPartner" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and organization_type =11 or organization_type=12
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	
	<!--线下  -->
	<select id="getPageListLine" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and (COMPANY_QY!=10 or COMPANY_QY is null)
		and organization_type =1
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.supplierId != null and parameter.supplierId !='' ">
			and supplier_id =#{parameter.supplierId,jdbcType=INTEGER}
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and withdraw_status = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>
	</select>
	
		<!--线下列表for POP使用  -->
	<select id="getPageListOffLine" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		and (COMPANY_QY!=10 or COMPANY_QY is null)
		and organization_type =1
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !=''  and parameter.status != 6">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.status == 6">
				and <![CDATA[status in (0,1)]]>
		</if>
		<if test="parameter.activeStatus != null and parameter.activeStatus !='' ">
			and active_status =#{parameter.activeStatus,jdbcType=INTEGER}
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>
	</select>

	<select id="getSubSuppliersByPid" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where parent_id = #{parentId,jdbcType=INTEGER} and status=1
	</select>
	
	<select id="getAllSupplierIdsByPid" resultMap="BaseResultMap"
		parameterType="java.lang.Long">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where parent_id = #{parentId,jdbcType=INTEGER} 
	</select>

	<select id="getSubSupplierIdsByPid" resultType="java.lang.Long"
		parameterType="java.lang.Long">
		select supplier_id
		from s_supplier
		where parent_id = #{parentId,jdbcType=INTEGER} and status=1
	</select>
	<select id="getIdNameMapBySupplierIds" resultType="java.util.HashMap">
		select supplier_id as supplierId,name as name
		from s_supplier
		where supplier_id in
		<foreach item="item" index="index" collection="list" open="("
			separator="," close=")">
			#{item}
		</foreach>
	</select>
	<select id="getSuppliersByName" resultType="int" parameterType="java.lang.String">
		select
		COUNT(0)
		from s_supplier
		where name = #{name,jdbcType=VARCHAR} and status!=2
	</select>
	<select id="getOnkeySendSupplierBySupplierIds" resultMap="BaseResultMap">
		select * from s_supplier
		where is_onkey_send='2' and status='1'
		<if test="list != null and list.size>0">
			and supplier_id in
			<foreach item="item" index="index" collection="list" open="("
				separator="," close=")">
				#{item}
			</foreach>
		</if>
	</select>
	<select id="getSupplierCodeId" resultType="int" parameterType="java.lang.String">
		select
		supplier_code_num
		from s_supplier_code_type
		where supplier_code_type = #{supplierCodeType,jdbcType=VARCHAR}
	</select>
	<update id="updateSupplierCodeNumByType" parameterType="com.mall.supplier.model.SupplierCodeType">
		update s_supplier_code_type
		<set>
			<if test="supplierCodeNum != null">
				supplier_code_num = #{supplierCodeNum,jdbcType=VARCHAR}
			</if>
		</set>
		where supplier_code_type = #{supplierCodeType,jdbcType=INTEGER}
	</update>
	<update id="updateBackupInfo" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier
		<set>
			<if test="companyLegitimacyUrl != null">
				company_legitimacy_url = #{companyLegitimacyUrl,jdbcType=VARCHAR},
			</if>
			<if test="contact != null">
				contact = #{contact,jdbcType=VARCHAR},
			</if>
			<if test="phone != null">
				phone= #{phone,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				email = #{email,jdbcType=VARCHAR},
			</if>
			<if test="userName != null">
				user_name= #{userName,jdbcType=VARCHAR},
			</if>
			<if test="address !=null">
				address= #{address,jdbcType=VARCHAR},
			</if>
			
			<if test="companyDetailedUrl != null">
				company_detailed_url = #{companyDetailedUrl,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="nameJC != null">
				name_jc = #{nameJC,jdbcType=VARCHAR},
			</if>
			<if test="companyInfo != null">
				company_info = #{companyInfo,jdbcType=VARCHAR},
			</if>
			<if test="managerBackup != null">
				manager_backup = #{managerBackup,jdbcType=VARCHAR},
			</if>
			<if test="managerTelBackup != null">
				manager_tel_backup = #{managerTelBackup,jdbcType=VARCHAR},
			</if>
			<if test="kfTelBackup != null">
				kf_tel_backup = #{kfTelBackup,jdbcType=VARCHAR},
			</if>
			<if test="addressBackup != null">
				address_backup = #{addressBackup,jdbcType=VARCHAR},
			</if>
			<if test="contactBackup != null">
				contact_backup = #{contactBackup,jdbcType=VARCHAR},
			</if>
			<if test="phoneBackup != null">
				phone_backup = #{phoneBackup,jdbcType=VARCHAR},
			</if>
			<if test="emailBackup != null">
				email_backup = #{emailBackup,jdbcType=VARCHAR},
			</if>
			<if test="faxBackup != null">
				fax_backup = #{faxBackup,jdbcType=VARCHAR},
			</if>
			<if test="countryAreaBackup != null">
				country_area_backup = #{countryAreaBackup,jdbcType=VARCHAR},
			</if>
			<if test="postBackup != null">
				post_backup = #{postBackup,jdbcType=VARCHAR},
			</if>
			<if test="logoImgurlBackup != null">
				logo_imgurl_backup = #{logoImgurlBackup,jdbcType=VARCHAR},
			</if>
			<if test="modifyStatus != null">
				modify_status = #{modifyStatus,jdbcType=INTEGER},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=INTEGER},
			</if>
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<update id="updateInfo" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier
		<set>
			<if test="companyLegitimacyUrl != null">
				company_legitimacy_url = #{companyLegitimacyUrl,jdbcType=VARCHAR},
			</if>
			<if test="companyDetailedUrl != null">
				company_detailed_url = #{companyDetailedUrl,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="nameJC != null">
				name_jc = #{nameJC,jdbcType=VARCHAR},
			</if>
			<if test="companyInfo != null">
				company_info = #{companyInfo,jdbcType=VARCHAR},
			</if>
			<if test="managerBackup != null">
				manager_backup = #{managerBackup,jdbcType=VARCHAR},
			</if>
			<if test="managerTelBackup != null">
				manager_tel_backup = #{managerTelBackup,jdbcType=VARCHAR},
			</if>
			<if test="kfTelBackup != null">
				kf_tel = #{kfTelBackup,jdbcType=VARCHAR},
			</if>
			<if test="addressBackup != null">
				address_backup = #{addressBackup,jdbcType=VARCHAR},
			</if>
			<if test="contactBackup != null">
				contact = #{contactBackup,jdbcType=VARCHAR},
			</if>
			<if test="phoneBackup != null">
				phone_backup = #{phoneBackup,jdbcType=VARCHAR},
			</if>
			<if test="emailBackup != null">
				email = #{emailBackup,jdbcType=VARCHAR},
			</if>
			<if test="faxBackup != null">
				fax_backup = #{faxBackup,jdbcType=VARCHAR},
			</if>
			<if test="countryAreaBackup != null">
				country_area_backup = #{countryAreaBackup,jdbcType=VARCHAR},
			</if>
			<if test="postBackup != null">
				post_backup = #{postBackup,jdbcType=VARCHAR},
			</if>
			<if test="logoImgurlBackup != null">
				logo_imgurl_backup = #{logoImgurlBackup,jdbcType=VARCHAR},
			</if>
			<if test="modifyStatus != null">
				modify_status = #{modifyStatus,jdbcType=INTEGER},
			</if>
			<if test="status != null">
				status = #{status,jdbcType=INTEGER},
			</if>
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<select id="getSupplierBySupplierCode" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where supplier_code = #{supplierCode,jdbcType=VARCHAR} limit 0,1
	</select>

	<!-- 查询我的推荐企业列表 -->
	<select id="getTjEnterpriseList" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where user_tj = #{userId,jdbcType=VARCHAR}
	</select>
	<select id="getSupplierByTjUser" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where user_tj = #{oldMobile,jdbcType=VARCHAR}
	</select>
	<select id="getPageListAll" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		
		
		<if test="parameter.name!= null and parameter.name !='' ">
			and name like
			CONCAT('%',#{parameter.name,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.address!= null and parameter.address !='' ">
			and address like
			CONCAT('%',#{parameter.address,jdbcType=VARCHAR},'%')
		</if>
		<if test="parameter.type != null and parameter.type !='' ">
			and type =#{parameter.type,jdbcType=VARCHAR}
		</if>
		<if test="parameter.parentId != null and parameter.parentId !='' ">
			and parent_id =#{parameter.parentId,jdbcType=INTEGER}
		</if>
		<if test="parameter.status != null and parameter.status !='' ">
			<if test="parameter.status == 0">
				and <![CDATA[( status = 0 OR status IS NULL )]]>
			</if>
			<if test="parameter.status != 0">
				and status = #{ parameter.status,jdbcType=INTEGER}
			</if>
		</if>
		<if test="parameter.supplyType != null and parameter.supplyType !='' ">
			and supply_type = #{ parameter.supplyType,jdbcType=INTEGER}
		</if>
		<if test="parameter.auditTime != null and parameter.auditTime !=''">
			AND <![CDATA[ DATE_FORMAT(audit_time,'%Y%m%d') = DATE_FORMAT(#{parameter.auditTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>
		<if test="parameter.createTime != null and parameter.createTime !=''">
			AND <![CDATA[ DATE_FORMAT(create_time,'%Y%m%d') = DATE_FORMAT(#{parameter.createTime,jdbcType=TIMESTAMP},'%Y%m%d')]]>
		</if>

		<if test="parameter.userTj != null and parameter.userTj !='' ">
			and user_tj =#{parameter.userTj,jdbcType=VARCHAR}
		</if>
		<if test="parameter.supplierCode != null and parameter.supplierCode !='' ">
			and supplier_code like
			CONCAT('%',#{parameter.supplierCode,jdbcType=VARCHAR},'%')
		</if>

	</select>
	<select id="getPageListAllyinlian" parameterType="java.util.Map"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status!=3
		
		
		<if test="parameter.name!= null and parameter.name !='' ">
			and name =#{parameter.name,jdbcType=VARCHAR}
			
		</if>
		<if test="parameter.legalPersonCardNo!= null and parameter.legalPersonCardNo !='' ">
			and legal_person_cardno =#{parameter.legalPersonCardNo,jdbcType=VARCHAR}
		</if>
		<if test="parameter.accountNo!= null and parameter.accountNo !='' ">
			and accout_no =#{parameter.accountNo,jdbcType=VARCHAR}
		</if>

	</select>
	<update id="newUpdateByPrimaryKeySelective"  parameterType="com.mall.supplier.model.Supplier">
		update s_supplier
		<set>
			<if test="supplierCode != null">
				supplier_code = #{supplierCode,jdbcType=VARCHAR},
			</if>
			<if test="name != null">
				name = #{name,jdbcType=VARCHAR},
			</if>
			<if test="organizationalForm != null">
				organizational_form = #{organizationalForm,jdbcType=CHAR},
			</if>
			<if test="companyInfo != null">
				company_info = #{companyInfo,jdbcType=VARCHAR},
			</if>
			<if test="businessLicense != null">
				business_license = #{businessLicense,jdbcType=VARCHAR},
			</if>
			<if test="healthLicense != null">
				health_license = #{healthLicense,jdbcType=VARCHAR},
			</if>
			<if test="linesOfCredit != null">
				lines_of_credit = #{linesOfCredit,jdbcType=VARCHAR},
			</if>
			<if test="legalPerson != null">
				legal_person = #{legalPerson,jdbcType=VARCHAR},
			</if>
			<if test="taxLicense != null">
				tax_license = #{taxLicense,jdbcType=VARCHAR},
			</if>
			<if test="franchiseLicense != null">
				franchise_license = #{franchiseLicense,jdbcType=VARCHAR},
			</if>
			<if test="mainCategory != null">
				main_category = #{mainCategory,jdbcType=VARCHAR},
			</if>
			<if test="cityId != null">
				city_id = #{cityId,jdbcType=INTEGER},
			</if>
			<if test="areaId != null">
				area_id = #{areaId,jdbcType=INTEGER},
			</if>
			<if test="address != null">
				address = #{address,jdbcType=VARCHAR},
			</if>
			<if test="contact != null">
				contact = #{contact,jdbcType=VARCHAR},
			</if>
			<if test="email != null">
				email = #{email,jdbcType=VARCHAR},
			</if>
			<if test="phone != null">
				phone = #{phone,jdbcType=VARCHAR},
			</if>
			<if test="fax != null">
				fax = #{fax,jdbcType=VARCHAR},
			</if>
			<if test="post != null">
				post = #{post,jdbcType=INTEGER},
			</if>
			<if test="createTime != null">
				create_time = #{createTime,jdbcType=TIMESTAMP},
			</if>
			<if test="createBy != null">
				create_by = #{createBy,jdbcType=VARCHAR},
			</if>
			<if test="lastModifyTime != null">
				last_modify_time = #{lastModifyTime,jdbcType=TIMESTAMP},
			</if>
			<if test="auditTime != null">
				audit_time = #{auditTime,jdbcType=DATE},
			</if>
			<if test="companyWebsite != null">
				company_website = #{companyWebsite,jdbcType=VARCHAR},
			</if>
			<if test="companyNature != null">
				company_nature = #{companyNature,jdbcType=VARCHAR},
			</if>
			<if test="countryArea != null">
				country_area = #{countryArea,jdbcType=VARCHAR},
			</if>
			<if test="icon != null">
				icon = #{icon,jdbcType=VARCHAR},
			</if>
			<if test="companyDescribe != null">
				company_describe = #{companyDescribe,jdbcType=VARCHAR},
			</if>
			<if test="companyLegitimacyUrl != null">
				company_legitimacy_url = #{companyLegitimacyUrl,jdbcType=VARCHAR},
			</if>
			<if test="companyDetailedUrl != null">
				company_detailed_url = #{companyDetailedUrl,jdbcType=VARCHAR},
			</if>
			<if test="checkFailReason != null">
				check_fail_reason = #{checkFailReason,jdbcType=VARCHAR},
			</if>
			<if test="manager != null">
				manager = #{manager,jdbcType=VARCHAR},
			</if>
			<if test="managerTel != null">
				manager_tel = #{managerTel,jdbcType=VARCHAR},
			</if>
			<if test="kfTel != null">
				kf_tel = #{kfTel,jdbcType=VARCHAR},
			</if>
			<if test="logoImgurl != null">
				logo_imgurl = #{logoImgurl,jdbcType=VARCHAR},
			</if>
			<if test="companyQy != null">
				company_qy = #{companyQy,jdbcType=VARCHAR},
			</if>
			<if test="companyRegion != null">
				company_region = #{companyRegion,jdbcType=VARCHAR},
			</if>
			<if test="companyLevel != null">
				company_level = #{companyLevel,jdbcType=VARCHAR},
			</if>
			<if test="userTj != null">
				user_tj = #{userTj,jdbcType=VARCHAR},
			</if>
            <if test="idCardFront != null">
                idCard_front = #{idCardFront,jdbcType=VARCHAR},
            </if>
            <if test="idCardVerso != null">
                idCard_verso = #{idCardVerso,jdbcType=VARCHAR},
            </if>
            <if test="companyBizType != null">
                company_biz_type = #{companyBizType,jdbcType=INTEGER},
            </if>
            <if test="companyBizCategory != null">
                company_biz_category = #{companyBizCategory,jdbcType=INTEGER},
            </if>
             <if test="type != null">
                type = #{type,jdbcType=INTEGER},
            </if>
             <if test="companyStoreLogo != null">
                company_store_logo = #{companyStoreLogo,jdbcType=VARCHAR},
            </if>
             <if test="businessLicenseNo != null">
                business_licenseno = #{businessLicenseNo,jdbcType=VARCHAR},
            </if>
             <if test="nameJC != null">
                name_jc = #{nameJC,jdbcType=VARCHAR},
            </if>
             <if test="provinceId != null">
                province_id = #{provinceId,jdbcType=INTEGER},
            </if>
             <if test="cityId != null">
                city_id = #{cityId,jdbcType=INTEGER},
            </if>
             <if test="areaId != null">
                area_id = #{areaId,jdbcType=INTEGER},
            </if>
             <if test="registerAddress != null">
                register_address = #{registerAddress,jdbcType=VARCHAR},
            </if>
             <if test="contactTel != null">
                contact_tel = #{contactTel,jdbcType=VARCHAR},
            </if>
             <if test="legalPersonPhone != null">
                legal_person_phone = #{legalPersonPhone,jdbcType=VARCHAR},
            </if>
             <if test="legalPersonCardNo != null">
                legal_person_cardno = #{legalPersonCardNo,jdbcType=VARCHAR},
            </if>
             <if test="accoutBankno != null">
                accout_bankno = #{accoutBankno,jdbcType=VARCHAR},
            </if>
             <if test="accoutBankname != null">
                accout_bankname = #{accoutBankname,jdbcType=VARCHAR},
            </if>
             <if test="accountName != null">
                accout_name = #{accountName,jdbcType=VARCHAR},
            </if>
             <if test="accountNo != null">
                accout_no = #{accountNo,jdbcType=VARCHAR},
            </if>
             <if test="modifyStatus != null">
                modify_status = #{modifyStatus,jdbcType=INTEGER},
            </if>
             <if test="status != null">
                status = #{status,jdbcType=INTEGER},
            </if>
             <if test="activeStatus != null">
                active_status = #{activeStatus,jdbcType=INTEGER},
            </if>
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<update id="updateRemainBAmount">
		update s_supplier
		<set>
			remain_balance_amount = #{remainBalanceAmount,jdbcType=DECIMAL}
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<select id="findSupplier" parameterType="com.mall.supplier.model.Supplier"
		resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		<where>
			status = 1 and
			<trim prefixOverrides="and">
				<if test="supplierId != null">
					and supplier_id = #{supplierId,jdbcType=INTEGER}
				</if>
				<if test="supplierCode != null">
					and supplier_code = #{supplierCode,jdbcType=VARCHAR}
				</if>
				<if test="name != null">
					and name = #{name,jdbcType=VARCHAR}
				</if>
				<if test="phone != null">
					and phone = #{phone,jdbcType=VARCHAR}
				</if>
				<if test="createTime != null">
					and create_time = #{createTime,jdbcType=TIMESTAMP}
				</if>
				<if test="createBy != null">
					and create_by = #{createBy,jdbcType=VARCHAR}
				</if>
				<if test="companyNature != null">
					and company_nature = #{companyNature,jdbcType=VARCHAR}
				</if>
				<if test="countryArea != null">
					and country_area = #{countryArea,jdbcType=VARCHAR}
				</if>
				<if test="manager != null">
					and manager = #{manager,jdbcType=VARCHAR}
				</if>
				<if test="managerTel != null">
					and manager_tel = #{managerTel,jdbcType=VARCHAR}
				</if>
				<if test="kfTel != null">
					and kf_tel = #{kfTel,jdbcType=VARCHAR}
				</if>
				<if test="companyQy != null">
					and company_qy = #{companyQy,jdbcType=VARCHAR}
				</if>
				<if test="companyRegion != null">
					and company_region = #{companyRegion,jdbcType=VARCHAR}
				</if>
				<if test="companyLevel != null">
					and company_level = #{companyLevel,jdbcType=VARCHAR}
				</if>
				<if test="sjSupplierId != null">
					and sj_supplier_id = #{sjSupplierId,jdbcType=VARCHAR}
				</if>
                <if test="idCardFront != null">
                   and idCard_front = #{idCardFront,jdbcType=VARCHAR},
                </if>
                <if test="idCardVerso != null">
                   and idCard_verso = #{idCardVerso,jdbcType=VARCHAR},
                </if>
			</trim>
		</where>
	</select>
	<update id="updateHqqPwdBySupplierId">
		update s_supplier
		<set>
			hqq_pwd = #{newHqqPwd,jdbcType=VARCHAR}
		</set>
		where supplier_id = #{supplierId,jdbcType=INTEGER}
	</update>
	<select id="findAllSupplierByCommpanyQy" resultMap="BaseResultMap"
		parameterType="java.lang.String">
		select
		<include refid="Base_Column_List" />
		from s_supplier
		where status = 1 and company_qy = #{companyQy,jdbcType=VARCHAR}
	</select>
	<select id="getSupplierRelationBySupplierCode" resultMap="BaseResultMap"
		parameterType="com.mall.supplier.model.Supplier">
  	<![CDATA[
  		SELECT 1 level,s.* FROM s_supplier s WHERE s.`status` = 1 AND 
		s.supplier_id = (SELECT s1.sj_supplier_id FROM s_supplier s1 
		WHERE s1.status = 1 AND s1.supplier_code = #{supplier.supplierCode,jdbcType=VARCHAR} 
		OR s1.`name` = #{supplier.name,jdbcType=VARCHAR})
		UNION ALL
		SELECT 2 level,s2.* FROM s_supplier s2 WHERE s2.`status` = 1 AND s2.sj_supplier_id = (
		SELECT s3.supplier_id FROM s_supplier s3 
		WHERE s3.status = 1 AND s3.supplier_code = #{supplier.supplierCode,jdbcType=VARCHAR} 
		or s3.`name` = #{supplier.name,jdbcType=VARCHAR}
		) LIMIT #{page},#{pageSize} ;
  	]]>
	</select>
	<select id="getSupplierList" resultMap="BaseResultMap"
		parameterType="com.mall.supplier.model.Supplier">
  	<![CDATA[
  		SELECT s.* FROM s_supplier s WHERE s.`status` = 1 AND 
		s.supplier_id = (SELECT s1.sj_supplier_id FROM s_supplier s1 
		WHERE s1.status = 1 AND s1.supplier_code = #{supplier.supplierCode,jdbcType=VARCHAR} 
		OR s1.`name` = #{supplier.name,jdbcType=VARCHAR})
		UNION ALL
		SELECT s2.* FROM s_supplier s2 WHERE s2.`status` = 1 AND s2.sj_supplier_id = (
		SELECT s3.supplier_id FROM s_supplier s3 
		WHERE s3.status = 1 AND s3.supplier_code = #{supplier.supplierCode,jdbcType=VARCHAR} 
		or s3.`name` = #{supplier.name,jdbcType=VARCHAR}
		);
  	]]>
	</select>
  <select id="countByExample" parameterType="com.mall.supplier.enums.EasyUIPageSupplier" resultType="java.lang.Integer" >
    select count(s.supplier_id) from  s_supplier s 
    where 1=1
    <if test="supplier_code!=null and supplier_code!=''" >
    and	s.supplier_code = #{supplier_code,jdbcType=VARCHAR}
    </if>
    <if test="name!=null and name!=''" >
    and	s.name like CONCAT('%',#{name,jdbcType=VARCHAR},'%')
    </if>
    <if test="status!=null" >
    and	s.status = #{status,jdbcType=INTEGER}
    </if>
    <if test="userMobile!=null and userMobile!=''" >
    and	(s.user_mobile = #{userMobile,jdbcType=VARCHAR} or s.phone =#{userMobile,jdbcType=VARCHAR})
    </if>
    <if test="userid==1">
    and s.organization_type=5
    </if>
    <if test="userid==3">
    and s.organization_type =6
    </if>
    <if test="userid==2">
    and s.organization_type is null
    </if>
    
    
  </select>
  
   <select id="selectByExample" resultType="com.mall.supplier.model.Suppliernew" parameterType="com.mall.supplier.enums.EasyUIPageSupplier" >
    select 
    s.supplier_id,s.supplier_code,s.name,s.create_Time,s.status,s.organization_type
    from s_supplier s 
    where 1=1
     <if test="supplier_code!=null and supplier_code!=''" >
    and	s.supplier_code = #{supplier_code,jdbcType=VARCHAR}
    </if>
    <if test="name!=null and name!=''" >
    and	s.name like CONCAT('%',#{name,jdbcType=VARCHAR},'%')
    </if>
    <if test="status!=null" >
    and	s.status = #{status,jdbcType=INTEGER}
    </if>
      <if test="userMobile!=null and userMobile!=''" >
    and	(s.user_mobile = #{userMobile,jdbcType=VARCHAR} or s.phone =#{userMobile,jdbcType=VARCHAR})
    </if>
     <if test="userid==1">
    and s.organization_type=5
    </if>
    <if test="userid==3">
    and s.organization_type =6
    </if>
    <if test="userid==2">
    and s.organization_type is null
    </if>
     

    order by s.create_Time desc
    limit #{startpage},#{endpage} 
  </select>
	<update id="updatebyId" parameterType="java.lang.Integer">
		update s_supplier set status=5 where supplier_id=#{string,jdbcType=INTEGER}
	</update>
	<update id="frozenSupplier" parameterType="java.lang.Integer">
		update s_supplier set status=1 where supplier_id=#{string,jdbcType=INTEGER}
	</update>

	<update id="updateSupplier" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier set status=1,active_status=1,supplier_code=#{supplierCode,jdbcType=VARCHAR},audit_time=#{auditTime,jdbcType=TIMESTAMP},check_fail_reason=#{checkFailReason}
		 <if test="companyQy!=null and companyQy!=''" >
    	,	company_qy = #{companyQy,jdbcType=VARCHAR}
    	</if>
		 <if test="type!=null and type!=''" >
    	,	type = #{type,jdbcType=INTEGER}
    	</if>
		 <if test="noPayhqq!=null and noPayhqq!=''" >
    	,	no_pay_hqq = #{noPayhqq,jdbcType=DECIMAL}
    	</if>
		 <if test="fanliPrice!=null and fanliPrice!=''" >
    	,	fanli_price = #{fanliPrice,jdbcType=DECIMAL}
    	</if>
		 <if test="sjSupplierId!=null and sjSupplierId!=''" >
    	,	sj_supplier_id = #{sjSupplierId,jdbcType=DECIMAL}
    	</if>
		where supplier_id=#{supplierId,jdbcType=INTEGER}
	</update>
	<update id="updatetoSupplier" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier set status=2,audit_time=#{auditTime,jdbcType=TIMESTAMP},check_fail_reason=#{checkFailReason} 
		where supplier_id=#{supplierId,jdbcType=INTEGER}
	</update>
	<update id="saveupdateSupplier" parameterType="com.mall.supplier.model.Supplier">
		update s_supplier set name=#{name},supplier_code=#{supplierCode},phone=#{phone},contact=#{contact},kf_tel=#{managerTel},email=#{email}
		where supplier_id=#{supplierId}
	</update>
	
	<select id="findParentSupplier" resultMap="BaseResultMap">
		select
		<include refid="Base_Column_List"/>
		from s_supplier
		where
			status = 1
			<if test="supplierId != null">
				and supplier_id = #{supplierId,jdbcType=INTEGER}
			</if>
	</select>
    <select id="findSupplierByAreaPageList" resultMap="BaseResultMap">
		select <include refid="Base_Column_List"/>
		from s_supplier
		where
			status=1
			<if test="parameter.type!=null">
				and type = #{parameter.type}
			</if>
			<if test="parameter.organizationType!=null">
				and organization_type = #{parameter.organizationType}
			</if>
			<if test="parameter.provinceId!=null">
				and province_id=#{parameter.provinceId}
			</if>
			<if test="parameter.cityId!=null">
				and city_id=#{parameter.cityId}
			</if>
			<if test="parameter.areaId!=null">
				and area_id=#{parameter.areaId}
			</if>
	</select>

    <update id="updateSupplierParentId">
		UPDATE s_supplier s 
		SET  s.parent_id=#{parentId} 
		WHERE s.supplier_id IN 
		<foreach item="item" index="index" collection="list"
    		  	open="(" separator="," close=")">
       			 #{item}
  		</foreach>
	</update>
    <update id="updateSupplierWithdrawStatus">
		update s_supplier
		set withdraw_status=#{withdrawStatus}
		where supplier_id=#{supplierId}
	</update>
</mapper>